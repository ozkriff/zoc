language: rust

cache: cargo

rust:
    - nightly
    - beta
    - stable

matrix:
    allow_failures:
        - rust: nightly

os:
    - linux
    - osx

sudo: false

script:
    - make && make test

before_deploy:
    - mv target/release/zoc .
    - tar -zcvf zoc_$(date +%Y-%m-%d)-$TRAVIS_RUST_VERSION-$TRAVIS_OS_NAME.tar.gz assets zoc

deploy:
    provider: releases
    skip_cleanup: true
    overwrite: true
    file: zoc_$(date +%Y-%m-%d)-$TRAVIS_RUST_VERSION-$TRAVIS_OS_NAME.tar.gz
    api_key:
        secure: kRmQ4Dbeo0kdvrDuMGA+F9ohWhky1DDz5YbnTxkC0Rz5ahxuxaQMq2XCWhsHJ4IiwBN1XouNRR8+qtdh4B2sjyMNk936nHE+jR86Hiz33JJcxKfK7LgDTeeMiX5ZhOFNIiuNt8J1tyjqQkiYBnHJnTZ4z+vmx95a+svRlH4gz9RqtSPh/DRTNr1M4jqvHN3dQtC+uggwGI89UZadhrJQE3VM7brASdIBJn3JQSrfVFE1D3zIDfxVUwpPpMFOF+nlQzFlBkTkqe76HjHea9Z3HyL7XdTrNA7c33L+5fpznsJqYm/IT1AnW0FJ1nrHfByLJHMxPDZgUekwZAdWVINUbzT4MUbIJ07u2clfbcqRuoSnUsCzb6niFFgD1DAXR6j37THTV9l/yQDIWjLmkoU4nihsvuhjTvEEKyeEx8FXTtu1gcX+HDGZ6EMs4BDxKhIGA7ATXEnZuwyLQ2L3Z63V38UciIWK58D9CAguHsKRpMPM5U7QkXiT6vt8ddk0/ERlS8DKo5n9O+1V63J6ua2OYWdwUw396BMPhM8xQyxf0NvD5QGw1P9H/YadZ6zp5ezctkqmhmFvlx+F9McESiwg8y7XJm7JcZV9BQDscCw6Otr2WGf2XvcJme+yiBVuslSkS4NFnIa9x1VgdVKfdLEcw7fSqWfzcZZ4RD+uNIMBs2I=
    on:
        tags: true
